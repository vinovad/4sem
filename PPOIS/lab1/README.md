# Модель проверки качества продукции (Product Quality Control Model) 
Данная программная система предназначена для автоматизации контроля качества на производстве. Она позволяет отслеживать путь продукта от начальной стадии до упаковки, проверять его на соответствие стандартам (ГОСТ, внутренние стандарты), выдавать сертификаты и анализировать обратную связь от клиентов.

## Основные возможности (CLI)
*   **Управление продукцией:** Добавление новых продуктов, отслеживание их статуса и текущего этапа производства.
*   **Контроль этапов производства:** Поэтапное производство продукта (замес, выпечка, охлаждение, упаковка) с обязательной сертификацией на каждом этапе для перехода к следующему.
*   **Управление стандартами:** Проверка продуктов по трем встроенным стандартам качества (ГОСТ, Стандарт пекарни, Органический стандарт).
*   **Сертификация:** Выдача сертификатов соответствия продукта стандарту на конкретном этапе производства.
*   **Улучшение продукта:** Автоматическое "улучшение" характеристик продукта до уровня, требуемого выбранным стандартом.
*   **Обратная связь:** Добавление отзывов и рейтингов к продуктам.
*   **Аналитика:** Расчет среднего рейтинга продукта на основе отзывов.

---

## Документация классов(Domain)

### `Product`
**Файл:** `product.py`

Класс предназначен для представления и управления информацией о продукте на всех этапах его жизненного цикла.

 Как работает: Класс хранит все данные о продукте и предоставляет методы для их изменения. При создании продукт имеет начальные значения атрибутов, которые не соответствуют стандартам, и начинает с первого этапа производства.

*   **Атрибуты:**
    *   `product_id`: Уникальный идентификатор продукта.
    *   `name`: Название продукта.
    *   `attributes`: Словарь характеристик качества продукта ` ["defects" , "texture" , "smell", "taste"]`.
    *   `quality_checks`: Список результатов проверок качества.
    *   `reviews`: Список отзывов о продукте.
    *   `certificates`: Список выданных сертификатов.
    *   `status`: Статус продукта (production, quality_check, approved, rejected).
    *   `current_stage`: Индекс текущего этапа производства.
    *   `PRODUCTION_STAGES`: Список названий этапов производства `["dough", "baking", "cooling", "packaging"]`.
*   **Методы:**
    *   `get_current_stage()`: Возвращает название текущего этапа производства.
    *   `update_attribute(attribute, value)`: Обновляет значение указанного атрибута качества.
    *   `add_review(review)`: Добавляет отзыв к продукту.
    *   `__str__()`: Возвращает строковое представление продукта.
    
---

### `QualityStandard` (Абстрактный базовый класс)
**Файл:** `quality_standard.py`

Базовый класс для всех стандартов качества.

Как работает: Каждый стандарт определяет конкретные требования к качеству продукта. При проверке соответствия система сравнивает атрибуты продукта с требованиями выбранного стандарта.

*   **Атрибуты:**
    *   `standard_name`: Название стандарта.
    *   `criteria`: Словарь требуемых значений для атрибутов продукта.

### `GOSTStandard`
**Файл:** `quality_standard.py`

Класс, представляющий государственный стандарт (ГОСТ), наследуемый от `QualityStandard`.

*   **Атрибуты:**
    *   `standard_name`: "ГОСТ СТ-1".
    *   `criteria`: Требования: отсутствие дефектов `[" none"]`, хорошая текстура, запах и вкус `[ " good "]`.

### `BakeryEnterpriseStandard`
**Файл:** `quality_standard.py`

Класс, представляющий внутренний стандарт пекарни (повышенные требования), наследуемый от `QualityStandard`.

*   **Атрибуты:**
    *   `standard_name`: "Собственный стандарт пекарни".
    *   `criteria`: Требования: отсутствие дефектов `["none"]`, отличная текстура, запах и вкус `["excellent"]`.

### `OrganicBakeryStandard`
**Файл:** `quality_standard.py`

Класс, представляющий стандарт для органической продукции, наследуемый от `QualityStandard`.

*   **Атрибуты:**
    *   `standard_name`: "Органическая выпечка".
    *   `criteria`: Требования: отсутствие дефектов `[" none"]`, хорошая текстура и запах `[ " good "]`, отличный вкус `["excellent"]`.

---

### `ProductionStage` (Абстрактный базовый класс)
**Файл:** `production_stages.py`

Базовый класс для этапов производства, определяющий интерфейс проверки.

Как работает: Каждый этап проверяет конкретный атрибут продукта. Чтобы перейти к следующему этапу, продукт должен соответствовать требованиям текущего этапа и иметь действительный сертификат.

*   **Атрибуты:**
    *   `stage_name`: Название этапа.
*   **Методы:**
    *   `check(product)`: Абстрактный метод для проверки продукта на конкретном этапе. Должен быть переопределен в подклассах.

### `DoughStage` (Этап замеса)
**Файл:** `production_stages.py`

Класс, представляющий этап замеса теста. Наследуется от `ProductionStage`.

*   **Методы:**
    *   `check(product)`: Проверяет атрибут `defects`. Возвращает сообщение о прохождении этапа, если дефекты отсутствуют `[" none"]`.

### `BakingStage` (Этап выпечки)
**Файл:** `production_stages.py`

Класс, представляющий этап выпечки. Наследуется от `ProductionStage`.

*   **Методы:**
    *   `check(product)`: Проверяет атрибут (texture). Возвращает сообщение о прохождении этапа, если текстура хорошая `[ " good "]` или отличная `["excellent"]`.

### `CoolingStage` (Этап охлаждения)
**Файл:** `production_stages.py`

Класс, представляющий этап охлаждения. Наследуется от `ProductionStage`.

*   **Методы:**
    *   `check(product)`: Проверяет атрибут (smell). Возвращает сообщение о прохождении этапа, если запах хороший `[ " good "]` или отличный `["excellent"]`.

### `PackagingStage` (Этап упаковки)
**Файл:** `production_stages.py`

Класс, представляющий этап упаковки. Наследуется от `ProductionStage`.

*   **Методы:**
    *   `check(product)`: Проверяет атрибут `taste`. Возвращает сообщение о прохождении этапа, если вкус хороший `[ " good "]` или отличный `["excellent"]`.

---

### `Certificate`
**Файл:** `certificate.py`

Класс предназначен для представления сертификата качества, выданного продукту на определенном этапе.

Как работает: При выдаче сертификата устанавливается срок действия (1 год). Система проверяет действительность сертификата перед разрешением перехода к следующему этапу производства.

*   **Атрибуты:**
    *   `certificate_id`: Уникальный идентификатор сертификата.
    *   `product_id`: Идентификатор продукта, которому выдан сертификат.
    *   `stage`: Этап производства, на котором выдан сертификат.
    *   `standard`: Стандарт качества, по которому проведена сертификация.
    *   `issue_date`: Дата выдачи сертификата.
    *   `expiration_date`: Дата истечения срока действия (через год).
*   **Методы:**
    *   `is_valid()`: Проверяет, действителен ли сертификат на текущую дату.
    *   `__str__()`: Возвращает строковое представление сертификата.
---

### `Review`
**Файл:** `review.py`

Класс предназначен для представления отзыва о продукте.
 
Как работает:  Класс хранит информацию об отзыве и проверяет корректность рейтинга (от 1 до 5). Отзывы используются для анализа качества продукта.

*   **Атрибуты:**
    *   `product_id`: Идентификатор продукта, к которому относится отзыв.
    *   `author`: Имя автора отзыва.
    *   `comment`: Текст отзыва.
    *   `rating`: Рейтинг продукта (целое число от 1 до 5).
    *   `date`: Дата и время написания отзыва.
*   **Методы:**
    *   `__str__()`: Возвращает строковое представление отзыва.
---

### `QualityController`
**Файл:** `quality_controller.py`

Главный контроллер системы, управляющий продуктами, этапами производства и стандартами. Реализует основную бизнес-логику приложения.

Как работает: Контроллер является центральным элементом системы, связывающим все остальные классы. Он реализует бизнес-логику приложения и обеспечивает взаимодействие между различными компонентами системы.

*   **Атрибуты:**
    *   `products`: Список всех продуктов в системе.
    *   `quality_standards`: Словарь доступных стандартов качества.
    *   `production_stages`: Список экземпляров этапов производства (`DoughStage`, `BakingStage`, `CoolingStage`, `PackagingStage`).
*   **Методы:**
    *   `get_standard(standard_name)`: Возвращает объект стандарта по его имени.
    *   `add_product(name)`: Создает и добавляет новый продукт в систему.
    *   `show_products()`: Возвращает список кортежей (ID, имя) для всех продуктов.
    *   `get_product(product_id)`: Возвращает объект продукта по его ID.
    *   `has_certificate_for_current_stage(product_id)`: Проверяет наличие действующего сертификата для текущего этапа продукта.
    *   `advance_stage(product_id)`: Переводит продукт на следующий этап производства, если текущий этап пройден и сертифицирован.
    *   `is_production_complete(product_id)`: Проверяет, завершено ли производство продукта.
    *   `add_quality_check(product_id, stage, result)`: Добавляет запись о результате проверки качества.
    *   `add_certificate(product_id, certificate)`: Добавляет сертификат продукту.
    *   `check_compliance(product_id, standard)`: Проверяет, соответствует ли продукт заданному стандарту качества на текущем этапе.
    *   `certify_product(product_id, standard)`: Выдает сертификат продукту, если он соответствует стандарту и еще не имеет действующего сертификата на текущем этапе.
    *   `improve_product(product_id, standard)`: Улучшает атрибуты продукта, приводя их в соответствие с требованиями стандарта.
    *   `run_production(product_id)`: Запускает процесс производства, проверяет наличие сертификата и пытается перевести продукт на следующий этап.
    *   `add_review(product_id, author, comment, rating)`: Создает и добавляет новый отзыв к продукту.
    *   `analyze_reviews(product_id)`: Анализирует отзывы о продукте, вычисляет средний рейтинг и генерирует рекомендации.
---

### `main()`
**Файл:** `main.py`

```bash
# Запуск программы
python main.py  
```
Главная функция, реализующая цикл интерфейса командной строки (CLI). Она создает экземпляр `QualityController` и обрабатывает пользовательский ввод, вызывая соответствующие методы контроллера. Функция адаптирует меню в зависимости от наличия продуктов в системе:

*   Если продукты отсутствуют, доступны только пункты "1. Добавить продукт" и "2. Выход".
*   Если продукты есть, открывается полное меню со всеми функциями системы.
##Структура меню:##
Меню:
1. Добавить продукт
2. Список продуктов
3. Запустить производство (перейти к следующему этапу)
4. Проверить продукт по стандарту качества
5. Внести улучшения в продукт
6. Выдать сертификат продукту
7. Добавить отзыв
8. Анализировать отзывы
9. Выход
##Логика работы:
1)Добавление продукта (пункт 1)
Создается новый продукт с уникальным ID
Продукт начинает с этапа "dough" (замес теста)
Атрибуты продукта по умолчанию не соответствуют стандартам
2)Проверка продукта по стандарту (пункт 4)
Выбирается стандарт качества
Система проверяет каждый атрибут продукта на соответствие требованиям
Выводятся результаты проверки для каждого критерия
3)Внесение улучшений (пункт 5)
Система автоматически улучшает атрибуты продукта до уровня, требуемого выбранным стандартом
Например, если требуется "defects": "none", а у продукта "defects": "have", система изменит значение на "none"
4)Выдача сертификата (пункт 6)
Проверяется соответствие продукта стандарту
Если продукт соответствует стандарту и нет действительного сертификата для текущего этапа, выдается новый сертификат
Сертификат действителен 1 год
5)Запуск производства (пункт 3)
Проверяется наличие действительного сертификата для текущего этапа
Если сертификат есть, продукт переходит к следующему этапу
Если сертификата нет, выводится сообщение о необходимости прохождения проверки
6)Добавление отзыва (пункт 7)
Добавляется отзыв с рейтингом от 1 до 5
Система проверяет корректность введенных данных
7)Анализ отзывов (пункт 8)
Вычисляется средний рейтинг продукта
Если средний рейтинг ниже 4, система рекомендует улучшения


# Тестирование системы

Для обеспечения качества и корректности работы системы разработан набор модульных тестов с использованием фреймворка `pytest`. Тесты покрывают все основные компоненты системы и проверяют как позитивные, так и негативные сценарии.

### Запуск тестов

```bash
# Запуск с генерацией отчета о покрытии 
pytest tests.py --cov=domain --cov-report=term-missing
```

### Результаты тестирования

Все **44 теста** успешно проходят, обеспечивая высокое качество программной системы.

### Покрытие кода

Текущее покрытие кода тестами составляет **92%**:

| Модуль | Покрытие | Пропущенные строки |
|--------|----------|-------------------|
| `domain/__init__.py` | 100% | - |
| `domain/certificate.py` | 100% | - |
| `domain/domain_errors.py` | 100% | - |
| `domain/product.py` | 100% | - |
| `domain/production_stages.py` | 100% | - |
| `domain/quality_controller.py` | 85% | 77-78, 90-91, 115-116, 123-124, 150-152, 183-185, 205-206, 221-223, 238-242, 259-260 |
| `domain/quality_standard.py` | 100% | - |
| `domain/review.py` | 100% | - |
| **ИТОГО** | **92%** | **25 строк** |

### Структура тестов (44 теста)

#### Тесты класса `Product` (6 тестов)
*   `test_product_creation`: Проверка корректного создания продукта с начальными атрибутами и этапом производства.
*   `test_product_id_uniqueness`: Проверка уникальности идентификаторов создаваемых продуктов.
*   `test_update_attribute`: Проверка обновления атрибутов качества и обработки ошибок.
*   `test_add_review_to_product`: Проверка добавления отзывов к продукту.
*   `test_product_str`: Проверка строкового представления продукта.
*   `test_product_get_current_stage`: Проверка получения текущего этапа производства.

#### Тесты класса `Review` (3 теста)
*   `test_review_creation`: Проверка создания отзыва с корректными параметрами.
*   `test_review_invalid_rating`: Проверка обработки некорректных рейтингов.
*   `test_review_str`: Проверка строкового представления отзыва.

#### Тесты класса `Certificate` (3 теста)
*   `test_certificate_creation`: Проверка создания сертификата.
*   `test_certificate_validity`: Проверка валидности сертификата.
*   `test_certificate_str`: Проверка строкового представления сертификата.

#### Тесты этапов производства (5 тестов)
*   `test_dough_stage`: Проверка прохождения этапа замеса теста.
*   `test_baking_stage`: Проверка прохождения этапа выпечки.
*   `test_cooling_stage`: Проверка прохождения этапа охлаждения.
*   `test_packaging_stage`: Проверка прохождения этапа упаковки.
*   `test_production_stage_abstract`: Проверка абстрактного метода базового класса.

#### Тесты стандартов качества (3 теста)
*   `test_gost_standard`: Проверка корректности критериев стандарта ГОСТ.
*   `test_bakery_standard`: Проверка корректности критериев стандарта пекарни.
*   `test_organic_standard`: Проверка корректности критериев органического стандарта.

#### Тесты контроллера (`QualityController`) (24 теста)
*   `test_add_product`: Проверка добавления продукта в систему.
*   `test_show_products`: Проверка отображения списка продуктов.
*   `test_get_product`: Проверка получения продукта по ID.
*   `test_has_certificate_for_current_stage`: Проверка наличия сертификата для текущего этапа.
*   `test_advance_stage`: Проверка перехода на следующий этап производства.
*   `test_is_production_complete`: Проверка определения завершенности производства.
*   `test_add_quality_check`: Проверка добавления записи о проверке качества.
*   `test_add_certificate`: Проверка добавления сертификата продукту.
*   `test_check_compliance_success`: Проверка успешного соответствия стандарту.
*   `test_check_compliance_failure`: Проверка несоответствия стандарту.
*   `test_check_compliance_product_not_found`: Проверка обработки несуществующего продукта.
*   `test_certify_product_success`: Проверка успешной сертификации.
*   `test_certify_product_failure_no_compliance`: Проверка сертификации без соответствия.
*   `test_certify_product_already_exists`: Проверка обработки повторной сертификации.
*   `test_improve_product`: Проверка улучшения атрибутов продукта.
*   `test_improve_product_already_compliant`: Проверка улучшения уже соответствующего продукта.
*   `test_run_production`: Интеграционный тест полного цикла производства.
*   `test_add_review_success`: Проверка успешного добавления отзыва через контроллер.
*   `test_add_review_invalid_rating`: Проверка добавления отзыва с некорректным рейтингом.
*   `test_analyze_reviews`: Проверка анализа отзывов с высокими оценками.
*   `test_analyze_reviews_low_rating`: Проверка анализа отзывов с низкими оценками.
*   `test_analyze_reviews_no_reviews`: Проверка анализа при отсутствии отзывов.
*   `test_get_standard`: Проверка получения стандарта по имени.
*   `test_check_compliance_without_exception`: Проверка внутреннего метода без исключений.

### Итоги тестирования
*   **Всего тестов:** 44
*   **Успешно пройдено:** 44
*   **Общее покрытие кода:** 92%
