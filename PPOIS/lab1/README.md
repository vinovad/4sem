# Модель проверки качества продукции (Product Quality Control Model) 
Данная программная система предназначена для автоматизации контроля качества на производстве. Она позволяет отслеживать путь продукта от начальной стадии до упаковки, проверять его на соответствие стандартам (ГОСТ, внутренние стандарты), выдавать сертификаты и анализировать обратную связь от клиентов.

## Основные возможности (CLI)
*   **Управление продукцией:** Добавление новых продуктов, отслеживание их статуса и текущего этапа производства.
*   **Контроль этапов производства:** Поэтапное производство продукта (замес, выпечка, охлаждение, упаковка) с обязательной сертификацией на каждом этапе для перехода к следующему.
*   **Управление стандартами:** Проверка продуктов по трем встроенным стандартам качества (ГОСТ, Стандарт пекарни, Органический стандарт).
*   **Сертификация:** Выдача сертификатов соответствия продукта стандарту на конкретном этапе производства.
*   **Улучшение продукта:** Автоматическое "улучшение" характеристик продукта до уровня, требуемого выбранным стандартом.
*   **Обратная связь:** Добавление отзывов и рейтингов к продуктам.
*   **Аналитика:** Расчет среднего рейтинга продукта на основе отзывов.

---

## Документация классов(Domain)

### `Product`
**Файл:** `product.py`

Класс предназначен для представления и управления информацией о продукте на всех этапах его жизненного цикла.

*   **Атрибуты:**
    *   `product_id`: Уникальный идентификатор продукта.
    *   `name`: Название продукта.
    *   `attributes`: Словарь характеристик качества продукта ` ["defects" , "texture" , "smell", "taste"]`.
    *   `quality_checks`: Список результатов проверок качества.
    *   `reviews`: Список отзывов о продукте.
    *   `certificates`: Список выданных сертификатов.
    *   `status`: Статус продукта (production, quality_check, approved, rejected).
    *   `current_stage`: Индекс текущего этапа производства.
    *   `PRODUCTION_STAGES`: Список названий этапов производства `["dough", "baking", "cooling", "packaging"]`.
*   **Методы:**
    *   `get_current_stage()`: Возвращает название текущего этапа производства.
    *   `update_attribute(attribute, value)`: Обновляет значение указанного атрибута качества.
    *   `add_review(review)`: Добавляет отзыв к продукту.
    *   `__str__()`: Возвращает строковое представление продукта.

---

### `QualityStandard` (Абстрактный базовый класс)
**Файл:** `quality_standard.py`

Базовый класс для всех стандартов качества.

*   **Атрибуты:**
    *   `standard_name`: Название стандарта.
    *   `criteria`: Словарь требуемых значений для атрибутов продукта.

### `GOSTStandard`
**Файл:** `quality_standard.py`

Класс, представляющий государственный стандарт (ГОСТ), наследуемый от `QualityStandard`.

*   **Атрибуты:**
    *   `standard_name`: "ГОСТ СТ-1".
    *   `criteria`: Требования: отсутствие дефектов `[" none"]`, хорошая текстура, запах и вкус `[ " good "]`.

### `BakeryEnterpriseStandard`
**Файл:** `quality_standard.py`

Класс, представляющий внутренний стандарт пекарни (повышенные требования), наследуемый от `QualityStandard`.

*   **Атрибуты:**
    *   `standard_name`: "Собственный стандарт пекарни".
    *   `criteria`: Требования: отсутствие дефектов `["none"]`, отличная текстура, запах и вкус `["excellent"]`.

### `OrganicBakeryStandard`
**Файл:** `quality_standard.py`

Класс, представляющий стандарт для органической продукции, наследуемый от `QualityStandard`.

*   **Атрибуты:**
    *   `standard_name`: "Органическая выпечка".
    *   `criteria`: Требования: отсутствие дефектов `[" none"]`, хорошая текстура и запах `[ " good "]`, отличный вкус `["excellent"]`.

---

### `ProductionStage` (Абстрактный базовый класс)
**Файл:** `production_stages.py`

Базовый класс для этапов производства, определяющий интерфейс проверки.

*   **Атрибуты:**
    *   `stage_name`: Название этапа.
*   **Методы:**
    *   `check(product)`: Абстрактный метод для проверки продукта на конкретном этапе. Должен быть переопределен в подклассах.

### `DoughStage` (Этап замеса)
**Файл:** `production_stages.py`

Класс, представляющий этап замеса теста. Наследуется от `ProductionStage`.

*   **Методы:**
    *   `check(product)`: Проверяет атрибут `defects`. Возвращает сообщение о прохождении этапа, если дефекты отсутствуют `[" none"]`.

### `BakingStage` (Этап выпечки)
**Файл:** `production_stages.py`

Класс, представляющий этап выпечки. Наследуется от `ProductionStage`.

*   **Методы:**
    *   `check(product)`: Проверяет атрибут (texture). Возвращает сообщение о прохождении этапа, если текстура хорошая `[ " good "]` или отличная `["excellent"]`.

### `CoolingStage` (Этап охлаждения)
**Файл:** `production_stages.py`

Класс, представляющий этап охлаждения. Наследуется от `ProductionStage`.

*   **Методы:**
    *   `check(product)`: Проверяет атрибут (smell). Возвращает сообщение о прохождении этапа, если запах хороший `[ " good "]` или отличный `["excellent"]`.

### `PackagingStage` (Этап упаковки)
**Файл:** `production_stages.py`

Класс, представляющий этап упаковки. Наследуется от `ProductionStage`.

*   **Методы:**
    *   `check(product)`: Проверяет атрибут `taste`. Возвращает сообщение о прохождении этапа, если вкус хороший `[ " good "]` или отличный `["excellent"]`.

---

### `Certificate`
**Файл:** `certificate.py`

Класс предназначен для представления сертификата качества, выданного продукту на определенном этапе.

*   **Атрибуты:**
    *   `certificate_id`: Уникальный идентификатор сертификата.
    *   `product_id`: Идентификатор продукта, которому выдан сертификат.
    *   `stage`: Этап производства, на котором выдан сертификат.
    *   `standard`: Стандарт качества, по которому проведена сертификация.
    *   `issue_date`: Дата выдачи сертификата.
    *   `expiration_date`: Дата истечения срока действия (через год).
*   **Методы:**
    *   `is_valid()`: Проверяет, действителен ли сертификат на текущую дату.
    *   `__str__()`: Возвращает строковое представление сертификата.

---

### `Review`
**Файл:** `review.py`

Класс предназначен для представления отзыва о продукте.

*   **Атрибуты:**
    *   `product_id`: Идентификатор продукта, к которому относится отзыв.
    *   `author`: Имя автора отзыва.
    *   `comment`: Текст отзыва.
    *   `rating`: Рейтинг продукта (целое число от 1 до 5).
    *   `date`: Дата и время написания отзыва.
*   **Методы:**
    *   `__str__()`: Возвращает строковое представление отзыва.

---

### `QualityController`
**Файл:** `quality_controller.py`

Главный контроллер системы, управляющий продуктами, этапами производства и стандартами. Реализует основную бизнес-логику приложения.

*   **Атрибуты:**
    *   `products`: Список всех продуктов в системе.
    *   `quality_standards`: Словарь доступных стандартов качества.
    *   `production_stages`: Список экземпляров этапов производства (`DoughStage`, `BakingStage`, `CoolingStage`, `PackagingStage`).
*   **Методы:**
    *   `get_standard(standard_name)`: Возвращает объект стандарта по его имени.
    *   `add_product(name)`: Создает и добавляет новый продукт в систему.
    *   `show_products()`: Возвращает список кортежей (ID, имя) для всех продуктов.
    *   `get_product(product_id)`: Возвращает объект продукта по его ID.
    *   `has_certificate_for_current_stage(product_id)`: Проверяет наличие действующего сертификата для текущего этапа продукта.
    *   `advance_stage(product_id)`: Переводит продукт на следующий этап производства, если текущий этап пройден и сертифицирован.
    *   `is_production_complete(product_id)`: Проверяет, завершено ли производство продукта.
    *   `add_quality_check(product_id, stage, result)`: Добавляет запись о результате проверки качества.
    *   `add_certificate(product_id, certificate)`: Добавляет сертификат продукту.
    *   `check_compliance(product_id, standard)`: Проверяет, соответствует ли продукт заданному стандарту качества на текущем этапе.
    *   `certify_product(product_id, standard)`: Выдает сертификат продукту, если он соответствует стандарту и еще не имеет действующего сертификата на текущем этапе.
    *   `improve_product(product_id, standard)`: Улучшает атрибуты продукта, приводя их в соответствие с требованиями стандарта.
    *   `run_production(product_id)`: Запускает процесс производства, проверяет наличие сертификата и пытается перевести продукт на следующий этап.
    *   `add_review(product_id, author, comment, rating)`: Создает и добавляет новый отзыв к продукту.
    *   `analyze_reviews(product_id)`: Анализирует отзывы о продукте, вычисляет средний рейтинг и генерирует рекомендации.

---

### `main()`
**Файл:** `main.py`

```bash
# Запуск программы
python main.py  
```
Главная функция, реализующая цикл интерфейса командной строки (CLI). Она создает экземпляр `QualityController` и обрабатывает пользовательский ввод, вызывая соответствующие методы контроллера. Функция адаптирует меню в зависимости от наличия продуктов в системе:

*   Если продукты отсутствуют, доступны только пункты "1. Добавить продукт" и "2. Выход".
*   Если продукты есть, открывается полное меню со всеми функциями системы.

# Тестирование системы

Для обеспечения качества и корректности работы системы разработан набор модульных тестов с использованием фреймворка `pytest`. Тесты покрывают все основные компоненты системы и проверяют как позитивные, так и негативные сценарии.

### Запуск тестов

```bash
# Запуск с генерацией отчета о покрытии 
pytest tests.py --cov=domain --cov-report=term-missing
```

### Результаты тестирования

Все **27 тестов** успешно проходят, обеспечивая высокое качество программной системы.

### Покрытие кода

Текущее покрытие кода тестами составляет **89%**:

| Модуль | Покрытие | Пропущенные строки |
|--------|----------|-------------------|
| `domain/__init__.py` | 100% | - |
| `domain/certificate.py` | 100% | - |
| `domain/product.py` | 96% | 35 |
| `domain/production_stages.py` | 97% | 13 |
| `domain/quality_controller.py` | 81% | 28-35, 45, 55, 67, 78, 86, 104-105, 121-122, 153-154, 170-171, 185-187, 196, 202, 205 |
| `domain/quality_standard.py` | 100% | - |
| `domain/review.py` | 100% | - |
| **ИТОГО** | **89%** | **27 строк** |

### Структура тестов (27 тестов)

#### Тесты класса `Product` (4 теста)
*   `test_product_creation`: Проверка корректного создания продукта с начальными атрибутами и этапом производства.
*   `test_product_id_uniqueness`: Проверка уникальности идентификаторов создаваемых продуктов.
*   `test_update_attribute`: Проверка обновления атрибутов качества и обработки ошибок.
*   `test_add_review`: Проверка добавления отзывов к продукту.

#### Тесты класса `Review` (2 теста)
*   `test_review_invalid_rating`: Проверка обработки некорректных рейтингов.
*   `test_review_str`: Проверка строкового представления отзыва.

#### Тесты класса `Certificate` (2 теста)
*   `test_certificate_validity`: Проверка валидности сертификата.
*   `test_certificate_str`: Проверка строкового представления сертификата.

#### Тесты стандартов качества (1 тест)
*   `test_gost_standard`: Проверка корректности критериев стандарта ГОСТ.
*   *(Дополнительные тесты для других стандартов могут быть добавлены)*

#### Тесты этапов производства (4 теста)
*   `test_dough_stage`: Проверка прохождения этапа замеса теста.
*   `test_baking_stage`: Проверка прохождения этапа выпечки.
*   `test_cooling_stage`: Проверка прохождения этапа охлаждения.
*   `test_packaging_stage`: Проверка прохождения этапа упаковки.

#### Тесты контроллера (`QualityController`) (14 тестов)
*   `test_add_product`: Проверка добавления продукта в систему.
*   `test_get_product`: Проверка получения продукта по ID.
*   `test_check_compliance`: Проверка соответствия продукта стандарту качества.
*   `test_improve_product`: Проверка улучшения атрибутов продукта.
*   `test_certify_product`: Проверка выдачи сертификата продукту.
*   `test_has_certificate_for_current_stage`: Проверка наличия сертификата для текущего этапа.
*   `test_advance_stage`: Проверка перехода на следующий этап производства.
*   `test_run_production`: Интеграционный тест полного цикла производства.
*   `test_add_quality_check`: Проверка добавления записи о проверке качества.
*   `test_add_certificate`: Проверка добавления сертификата продукту.
*   `test_is_production_complete`: Проверка определения завершенности производства.
*   `test_add_review_controller`: Проверка добавления отзыва через контроллер.
*   `test_analyze_reviews`: Проверка анализа отзывов с высокими оценками.
*   `test_analyze_reviews_negative`: Проверка анализа отзывов с низкими оценками.

### Итоги тестирования

*   **Всего тестов:** 27
*   **Успешно пройдено:** 27
*   **Общее покрытие кода:** 89%
